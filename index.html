<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quote Collection</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        /* CSS Variables for Light and Dark Themes */
        :root {
            /* Light theme colors (default) */
            --bg-primary: #f5f5f5;
            --bg-secondary: white;
            --text-primary: #333;
            --text-secondary: #7f8c8d;
            --text-tertiary: #2c3e50;
            --border-color: #ddd;
            --shadow: rgba(0,0,0,0.1);
            --shadow-hover: rgba(0,0,0,0.2);
            --quote-border: #3498db;
            --button-bg: #3498db;
            --button-bg-hover: #2980b9;
            --category-bg: #ecf0f1;
            --category-bg-hover: #d5dbdc;
            --tag-bg: #ffb366;
            --tag-bg-hover: #ff9933;
        }

        /* Dark theme colors */
        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --text-tertiary: #f0f0f0;
            --border-color: #444;
            --shadow: rgba(0,0,0,0.3);
            --shadow-hover: rgba(0,0,0,0.5);
            --quote-border: #5dade2;
            --button-bg: #3498db;
            --button-bg-hover: #5dade2;
            --category-bg: #3a3a3a;
            --category-bg-hover: #4a4a4a;
            --tag-bg: #ff9933;
            --tag-bg-hover: #ffb366;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Header section */
        .header {
            background-color: var(--bg-secondary);
            padding: 30px 20px;
            box-shadow: 0 2px 4px var(--shadow);
            margin-bottom: 0;
            transition: background-color 0.3s ease;
            position: relative;
        }

        /* Header quote container with logo */
        .header-quote-container {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 30px;
            margin-bottom: 20px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .header-logo {
            width: 100px;
            height: 100px;
            flex-shrink: 0;
        }

        .header-quote-text {
            flex: 1;
            max-width: 800px;
        }

        .header-quote-text h1 {
            margin-bottom: 10px;
            margin-top: 0;
        }

        .header-quote-text .tagline {
            margin-bottom: 0;
        }

        /* Sticky header for mobile */
        @media (max-width: 968px) {
            .header {
                position: sticky;
                top: 0;
                z-index: 1000;
                padding: 20px 15px;
            }

            .header-quote-container {
                gap: 20px;
            }

            .header-logo {
                width: 80px;
                height: 80px;
            }

            .header h1 {
                font-size: 1.8em;
                margin-bottom: 5px;
            }

            .header .tagline {
                font-size: 1em;
                margin-bottom: 15px;
            }

            .header .north-star {
                display: none;
            }
        }

        /* Main layout container */
        .main-container {
            display: flex;
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Sidebar on the left */
        .sidebar {
            flex: 0 0 350px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            position: sticky;
            top: 20px;
            align-self: flex-start;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        /* Main content area */
        .main-content {
            flex: 1;
            min-width: 0;
        }

        /* Mobile filter button */
        .mobile-filter-btn {
            display: none;
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }

        .mobile-filter-btn:hover {
            background-color: #2980b9;
        }

        /* Mobile responsive */
        @media (max-width: 968px) {
            .main-container {
                flex-direction: column;
            }

            /* Show filter button on mobile */
            .mobile-filter-btn {
                display: inline-block;
            }

            /* Hide sidebar by default on mobile */
            .sidebar {
                display: none;
                flex: 1;
                position: fixed;
                top: 0;
                left: 0;
                width: 80%;
                max-width: 350px;
                height: 100vh;
                background-color: white;
                z-index: 2000;
                overflow-y: auto;
                box-shadow: 2px 0 10px rgba(0,0,0,0.3);
                padding: 20px;
            }

            /* Show sidebar when active */
            .sidebar.active {
                display: flex;
                flex-direction: column;
                animation: slideIn 0.3s ease-out;
            }

            /* Slide in animation */
            @keyframes slideIn {
                from {
                    transform: translateX(-100%);
                }
                to {
                    transform: translateX(0);
                }
            }

            /* Overlay backdrop */
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 1500;
            }

            .sidebar-overlay.active {
                display: block;
            }

            /* Close button for sidebar */
            .sidebar-close-btn {
                display: block;
                background-color: #e74c3c;
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 4px;
                font-size: 0.9em;
                font-weight: bold;
                cursor: pointer;
                margin-bottom: 15px;
                align-self: flex-end;
            }

            .sidebar-close-btn:hover {
                background-color: #c0392b;
            }
        }

        /* Hide close button on desktop */
        .sidebar-close-btn {
            display: none;
        }

        h1 {
            color: var(--text-tertiary);
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .tagline {
            text-align: center;
            font-size: 1.2em;
            color: var(--text-secondary);
            font-style: italic;
            margin-bottom: 40px;
        }

        .north-star {
            max-width: 800px;
            margin: 20px auto 0;
            text-align: center;
        }

        .north-star p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }

        .status {
            text-align: center;
            color: #27ae60;
            font-weight: bold;
        }

        .quote-container {
            background-color: var(--bg-secondary);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px var(--shadow);
            margin-bottom: 20px;
            border-left: 4px solid var(--quote-border);
            transition: background-color 0.3s ease;
        }

        .quote-text {
            font-size: 1.3em;
            font-style: italic;
            color: var(--text-tertiary);
            margin-bottom: 15px;
        }

        .quote-author {
            text-align: right;
            color: var(--text-secondary);
            font-weight: bold;
        }

        /* CSS for the Add Quote form section */

        /* Each input field group (label + input) */
        .form-group {
            margin-bottom: 20px;                        /* Space between form fields */
        }

        /* Labels for the form inputs */
        .form-group label {
            display: block;                             /* Makes label take full width */
            margin-bottom: 8px;                         /* Space between label and input */
            color: var(--text-tertiary);                /* Dark gray color */
            font-weight: bold;                          /* Make text bold */
        }

        /* Text inputs and textarea styling */
        .form-group input,
        .form-group textarea {
            width: 100%;                                /* Full width of container */
            padding: 10px;                              /* Space inside the input */
            border: 2px solid var(--border-color);      /* Light gray border */
            border-radius: 4px;                         /* Slightly rounded corners */
            font-size: 1em;                             /* Same size as body text */
            font-family: inherit;                       /* Use same font as page */
            box-sizing: border-box;                     /* Include padding in width */
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        /* When user clicks into an input - highlight it with blue border */
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;                              /* Remove default browser outline */
            border-color: var(--button-bg);             /* Change border to blue */
        }

        /* The Add Quote button styling */
        .add-button {
            background-color: var(--button-bg);         /* Blue background */
            color: white;                               /* White text */
            padding: 12px 30px;                         /* Space inside button */
            border: none;                               /* Remove default border */
            border-radius: 4px;                         /* Rounded corners */
            font-size: 1em;                             /* Normal text size */
            font-weight: bold;                          /* Bold text */
            cursor: pointer;                            /* Show hand cursor on hover */
            transition: background-color 0.3s ease;
        }

        /* When user hovers mouse over the button - make it darker */
        .add-button:hover {
            background-color: var(--button-bg-hover);   /* Darker blue */
        }

        /* Quote of the Day section styling */
        .quote-of-day-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px var(--shadow-hover);
            margin-bottom: 20px;
            text-align: center;
            color: white;
        }

        .quote-of-day-section h2 {
            color: white;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .quote-of-day-section .date-badge {
            background-color: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            display: inline-block;
            margin-bottom: 15px;
        }

        .quote-of-day-container {
            background-color: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid rgba(255,255,255,0.5);
            margin-top: 15px;
        }

        .quote-of-day-container .quote-text {
            font-size: 1.4em;
            font-style: italic;
            color: white;
            margin-bottom: 10px;
        }

        .quote-of-day-container .quote-author {
            color: rgba(255,255,255,0.9);
            font-weight: bold;
            text-align: right;
        }

        /* Random quote section styling */
        .random-quote-section {
            background-color: var(--bg-secondary);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px var(--shadow);
            margin-bottom: 0;
            text-align: center;
            transition: background-color 0.3s ease;
        }

        .random-quote-section h2 {
            color: var(--button-bg);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        /* Random quote button styling */
        .random-button {
            background-color: #9b59b6;                  /* Purple background */
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-right: 10px;
        }

        .random-button:hover {
            background-color: #8e44ad;                  /* Darker purple */
        }

        /* Show all button styling */
        .show-all-button {
            background-color: #27ae60;                  /* Green background */
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            display: none;                              /* Hidden by default */
        }

        .show-all-button:hover {
            background-color: #229954;                  /* Darker green */
        }

        /* Sidebar sections styling */
        .search-section,
        .category-section,
        .export-section,
        .add-quote-section {
            background-color: var(--bg-secondary);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px var(--shadow);
            transition: background-color 0.3s ease;
        }

        .search-section h2,
        .category-section h2,
        .export-section h2,
        .add-quote-section h2 {
            color: var(--button-bg);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        /* Export buttons styling */
        .export-button {
            background-color: #16a085;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            transition: background-color 0.2s;
        }

        .export-button:hover {
            background-color: #138871;
        }

        .export-button:last-child {
            margin-bottom: 0;
        }

        /* Social media button hover effects */
        #shareTwitterButton:hover {
            background-color: #1a8cd8 !important;
        }

        #shareFacebookButton:hover {
            background-color: #365899 !important;
        }

        #shareLinkedInButton:hover {
            background-color: #006097 !important;
        }

        /* Search input box styling */
        #searchInput {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            font-size: 1em;
            font-family: inherit;
            box-sizing: border-box;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        /* When user clicks into the search box - highlight with blue border */
        #searchInput:focus {
            outline: none;
            border-color: var(--button-bg);
        }

        /* Search result count styling */
        .search-results-info {
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        /* Category filter specific styling */

        .category-group {
            margin-bottom: 20px;
        }

        .category-group h3 {
            color: var(--text-tertiary);
            font-size: 1em;
            margin-bottom: 10px;
            margin-top: 0;
        }

        .category-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .category-checkbox {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background-color: var(--category-bg);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .category-checkbox:hover {
            background-color: var(--category-bg-hover);
        }

        .category-checkbox input[type="checkbox"] {
            margin-right: 6px;
            cursor: pointer;
        }

        .category-checkbox label {
            cursor: pointer;
            font-size: 0.9em;
            user-select: none;
        }

        .clear-filters-button {
            background-color: #95a5a6;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            cursor: pointer;
            margin-top: 10px;
        }

        .clear-filters-button:hover {
            background-color: #7f8c8d;
        }

        /* Category tags on quotes */
        .quote-categories {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .category-tag {
            display: inline-block;
            padding: 4px 10px;
            background-color: var(--tag-bg);
            color: white;
            border-radius: 12px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .category-tag:hover {
            background-color: var(--tag-bg-hover);
        }

        /* Wikipedia link styling */
        .wiki-link {
            color: var(--button-bg);
            text-decoration: underline;
            transition: color 0.2s;
            cursor: pointer;
        }

        .wiki-link:hover {
            color: var(--button-bg-hover);
            text-decoration: underline;
        }

        /* Favorite button styling */
        .favorite-button {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            padding: 5px;
            margin-left: 10px;
            transition: transform 0.2s;
            float: right;
        }

        .favorite-button:hover {
            transform: scale(1.2);
        }

        .favorite-button.favorited {
            animation: heartBeat 0.3s ease-in-out;
        }

        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }

        /* Container for side-by-side sections */
        .side-by-side-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .side-by-side-container > * {
            flex: 1;
        }

        /* Stack on mobile */
        @media (max-width: 968px) {
            .side-by-side-container {
                flex-direction: column;
            }
        }

        /* Favorites section styling */
        .favorites-section {
            background-color: var(--bg-secondary);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px var(--shadow);
            margin-bottom: 0;
            text-align: center;
            transition: background-color 0.3s ease;
        }

        .favorites-section h2 {
            color: #e74c3c;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .favorites-button {
            background-color: #e74c3c;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-right: 10px;
        }

        .favorites-button:hover {
            background-color: #c0392b;
        }

        .favorites-button.active {
            background-color: #c0392b;
            box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
        }

        /* Back to Top button - Fixed in bottom-right corner */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: normal;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, background-color 0.2s, transform 0.2s;
            z-index: 1000;
            box-shadow: 0 4px 8px var(--shadow-hover);
        }

        .back-to-top.visible {
            opacity: 0.9;
            visibility: visible;
        }

        .back-to-top:hover {
            opacity: 1;
            background-color: var(--button-bg-hover);
            transform: translateY(-3px);
        }

        /* Mobile adjustment for back to top button */
        @media (max-width: 968px) {
            .back-to-top {
                bottom: 20px;
                right: 20px;
                padding: 8px 16px;
                font-size: 0.85em;
            }
        }

        /* Dark mode toggle switch - Top right corner */
        .dark-mode-container {
            position: absolute;
            top: 15px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            z-index: 100;
        }

        .dark-mode-icon {
            font-size: 0.95em;
            transition: transform 0.3s ease;
        }

        .dark-mode-text {
            font-size: 0.7em;
            color: var(--text-secondary);
            font-weight: 500;
            white-space: nowrap;
            text-align: center;
        }

        /* Toggle switch container - smaller size */
        .switch {
            position: relative;
            display: inline-block;
            width: 36px;
            height: 20px;
        }

        /* Hide default checkbox */
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 20px;
        }

        /* The sliding circle */
        .slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        /* When checked (dark mode on) */
        input:checked + .slider {
            background-color: var(--button-bg);
        }

        input:checked + .slider:before {
            transform: translateX(16px);
        }

        /* Hover effect */
        .slider:hover {
            box-shadow: 0 0 6px var(--shadow-hover);
        }

        /* Mobile adjustment for dark mode toggle */
        @media (max-width: 968px) {
            .dark-mode-container {
                top: 12px;
                right: 12px;
                gap: 3px;
            }

            .dark-mode-icon {
                font-size: 0.85em;
            }

            .switch {
                width: 32px;
                height: 18px;
            }

            .slider:before {
                height: 12px;
                width: 12px;
            }

            input:checked + .slider:before {
                transform: translateX(14px);
            }

            .dark-mode-text {
                font-size: 0.65em;
            }
        }

        /* Print-friendly styles - Commented out as we're using PDF export via jsPDF */
        /*
        @media print {
            .header,
            .sidebar,
            .mobile-filter-btn,
            .back-to-top,
            .dark-mode-container,
            .favorite-button,
            .quote-of-day-section,
            .random-quote-section,
            .favorites-section,
            .side-by-side-container {
                display: none !important;
            }

            body {
                background-color: white !important;
                color: black !important;
                font-size: 12pt;
                line-height: 1.5;
            }

            .main-container {
                display: block;
                padding: 0;
                margin: 0;
                max-width: 100%;
            }

            .main-content {
                width: 100%;
                max-width: 100%;
            }

            .quote-container {
                background-color: white !important;
                border: 1px solid #ddd !important;
                border-left: 4px solid #3498db !important;
                box-shadow: none !important;
                page-break-inside: avoid;
                margin-bottom: 15px;
                padding: 15px;
            }

            @page {
                margin: 1cm;
            }
        }
        */
    </style>
</head>
<body>
    <!-- Header Section -->
    <div class="header">
        <!-- Dark mode toggle switch - top right corner -->
        <div class="dark-mode-container">
            <div style="display: flex; align-items: center; gap: 6px;">
                <span class="dark-mode-icon">üåô</span>
                <label class="switch">
                    <input type="checkbox" id="darkModeToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="dark-mode-text">Light mode</div>
        </div>

        <div class="header-quote-container">
            <img src="quotes.png" alt="Quote Collection Logo" class="header-logo">
            <div class="header-quote-text">
                <h1>Quote Collection</h1>
                <p class="tagline">Discover quotes that inspire and resonate</p>
            </div>
        </div>
        <div class="north-star">
            <p>I'm building a quote collection for community so that we can save and revisit quotes that inspire or resonate with everyone.</p>
            <p>-notAIbot</p>
        </div>
        <button id="mobileFilterBtn" class="mobile-filter-btn">üîç Search & Filter</button>
    </div>

    <!-- Sidebar overlay for mobile -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Main Container with Sidebar and Content -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <div class="sidebar" id="sidebar">
            <button id="sidebarCloseBtn" class="sidebar-close-btn">‚úï Close</button>
            <!-- Search Section -->
    <div class="search-section">
        <h2>Search Quotes</h2>
        <input type="text" id="searchInput" placeholder="Search by quote text or author name...">
        <div id="searchResultsInfo" class="search-results-info"></div>
    </div>

    <!-- Category Filter Section -->
    <div class="category-section">
        <h2>Filter by Category</h2>

        <div class="category-group">
            <h3>Source</h3>
            <div class="category-checkboxes" id="sourceCategories">
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-tech" value="Tech">
                    <label for="cat-tech">Tech</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-cricket" value="Cricket">
                    <label for="cat-cricket">Cricket</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-movies" value="Movies">
                    <label for="cat-movies">Movies</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-hollywood" value="Hollywood">
                    <label for="cat-hollywood">Hollywood</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-bollywood" value="Bollywood">
                    <label for="cat-bollywood">Bollywood</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-sports" value="Sports">
                    <label for="cat-sports">Sports</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-leaders" value="Leaders">
                    <label for="cat-leaders">Leaders</label>
                </div>
            </div>
        </div>

        <div class="category-group">
            <h3>Theme</h3>
            <div class="category-checkboxes" id="themeCategories">
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-motivation" value="Motivation">
                    <label for="cat-motivation">Motivation</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-success" value="Success">
                    <label for="cat-success">Success</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-failure" value="Failure">
                    <label for="cat-failure">Failure</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-dreams" value="Dreams">
                    <label for="cat-dreams">Dreams</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-hardwork" value="Hard Work">
                    <label for="cat-hardwork">Hard Work</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-leadership" value="Leadership">
                    <label for="cat-leadership">Leadership</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-innovation" value="Innovation">
                    <label for="cat-innovation">Innovation</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-perseverance" value="Perseverance">
                    <label for="cat-perseverance">Perseverance</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-wisdom" value="Wisdom">
                    <label for="cat-wisdom">Wisdom</label>
                </div>
                <div class="category-checkbox">
                    <input type="checkbox" id="cat-courage" value="Courage">
                    <label for="cat-courage">Courage</label>
                </div>
            </div>
        </div>

        <button id="clearFiltersButton" class="clear-filters-button">Clear All Filters</button>
    </div>

    <!-- Export Section -->
    <div class="export-section">
        <h2>üì• Export & Share</h2>
        <button id="exportCurrentButton" class="export-button">üíæ Export Current View</button>
        <button id="exportFavoritesButton" class="export-button">‚ù§Ô∏è Export Favorites</button>
        <button id="exportAllButton" class="export-button">üìÑ Export All Quotes</button>
        <button id="exportPdfButton" class="export-button">üìï Export as PDF</button>
        <button id="emailButton" class="export-button">üìß Email Quotes</button>
        <h3 style="margin-top: 20px; margin-bottom: 10px; font-size: 1em; color: var(--text-tertiary);">Share on Social Media</h3>
        <button id="shareTwitterButton" class="export-button" style="background-color: #1DA1F2;">üê¶ Share on Twitter</button>
        <button id="shareFacebookButton" class="export-button" style="background-color: #4267B2;">üìò Share on Facebook</button>
        <button id="shareLinkedInButton" class="export-button" style="background-color: #0077B5;">üíº Share on LinkedIn</button>
    </div>

    <!-- Form Section: Where users can add new quotes -->
    <div class="add-quote-section">
        <h2>Add Your Own Quote</h2>
        <!-- The form element - collects user input -->
        <form id="quoteForm">
            <!-- First input group: for the quote text -->
            <div class="form-group">
                <label for="quoteText">Quote:</label>
                <!-- textarea allows multiple lines of text -->
                <!-- required means user must fill this out -->
                <textarea id="quoteText" name="quoteText" rows="3" required placeholder="Enter the quote here..."></textarea>
            </div>
            <!-- Second input group: for the author name -->
            <div class="form-group">
                <label for="quoteAuthor">Author:</label>
                <!-- input type="text" is a single-line text box -->
                <input type="text" id="quoteAuthor" name="quoteAuthor" required placeholder="Author name">
            </div>
            <!-- Submit button - triggers form submission -->
            <button type="submit" class="add-button">Add Quote</button>
        </form>
    </div>

        </div>
        <!-- End of Sidebar -->

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Quote of the Day Section -->
            <div class="quote-of-day-section">
                <h2>‚ú® Quote of the Day ‚ú®</h2>
                <div class="date-badge" id="todayDate">Loading...</div>
                <div class="quote-of-day-container" id="quoteOfDayContainer">
                    <p class="quote-text" id="quoteOfDayText">"Loading..."</p>
                    <p class="quote-author" id="quoteOfDayAuthor">‚Äî Loading...</p>
                </div>
            </div>

            <!-- Side-by-side container for Random Quote and Favorites -->
            <div class="side-by-side-container">
                <!-- Random Quote Section -->
                <div class="random-quote-section">
                    <h2>Feeling Lucky?</h2>
                    <button id="randomButton" class="random-button">Show Random Quote</button>
                    <button id="anotherRandomButton" class="random-button" style="display: none;">Show Another Random Quote</button>
                    <button id="showAllButton" class="show-all-button">Show All Quotes</button>
                </div>

                <!-- Favorites Section -->
                <div class="favorites-section">
                    <h2>‚ù§Ô∏è Your Favorites</h2>
                    <button id="showFavoritesButton" class="favorites-button">Show Favorites</button>
                    <button id="showAllFromFavoritesButton" class="show-all-button" style="display: none;">Show All Quotes</button>
                    <p id="favoritesCount" style="margin-top: 15px; color: var(--text-secondary); font-size: 0.9em;">0 favorites saved</p>
                </div>
            </div>

            <!-- Container where all quotes will appear -->
            <div id="quotesContainer"></div>
        </div>
        <!-- End of Main Content -->
    </div>
    <!-- End of Main Container -->

    <!-- Back to Top button - Fixed position, floats in bottom-right corner -->
    <button id="backToTopBtn" class="back-to-top">‚Üë Back to Top</button>

    <!-- Load the quote data from external file -->
    <!-- This must come BEFORE our main script so initialQuotes is available -->
    <script src="data.js"></script>

    <!-- jsPDF library for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // JavaScript starts here

        // Dark Mode functionality
        const THEME_STORAGE_KEY = 'themePreference';
        const darkModeToggle = document.getElementById('darkModeToggle');
        const darkModeIcon = document.querySelector('.dark-mode-icon');
        const darkModeText = document.querySelector('.dark-mode-text');

        // Function to apply theme
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                darkModeToggle.checked = true;
                darkModeIcon.textContent = '‚òÄÔ∏è';
                darkModeText.textContent = 'Dark mode';
            } else {
                document.documentElement.removeAttribute('data-theme');
                darkModeToggle.checked = false;
                darkModeIcon.textContent = 'üåô';
                darkModeText.textContent = 'Light mode';
            }
        }

        // Function to toggle theme
        function toggleTheme() {
            const newTheme = darkModeToggle.checked ? 'dark' : 'light';

            // Apply the new theme
            applyTheme(newTheme);

            // Save preference to localStorage
            localStorage.setItem(THEME_STORAGE_KEY, newTheme);
        }

        // Load saved theme preference on page load
        const savedTheme = localStorage.getItem(THEME_STORAGE_KEY);
        if (savedTheme) {
            applyTheme(savedTheme);
        }

        // Add event listener to dark mode toggle switch
        darkModeToggle.addEventListener('change', toggleTheme);

        // localStorage key - this is the name we use to store/retrieve quotes
        const STORAGE_KEY = 'quoteCollection';
        const FAVORITES_STORAGE_KEY = 'favoritesCollection';

        // Function to save quotes to localStorage
        // localStorage only stores strings, so we convert the array to JSON
        function saveQuotes() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(quotes));
        }

        // Function to load quotes from localStorage
        // Returns the saved quotes, or null if nothing is saved yet
        function loadQuotes() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                // If we found saved quotes, parse the JSON string back into an array
                return JSON.parse(saved);
            }
            return null;
        }

        // Favorites management functions
        function saveFavorites() {
            // Convert Set to Array before saving
            localStorage.setItem(FAVORITES_STORAGE_KEY, JSON.stringify(Array.from(favorites)));
        }

        function loadFavorites() {
            const saved = localStorage.getItem(FAVORITES_STORAGE_KEY);
            if (saved) {
                // Parse and convert back to Set
                return new Set(JSON.parse(saved));
            }
            return new Set();
        }

        // Function to get a unique ID for a quote (using text + author as identifier)
        function getQuoteId(quote) {
            return quote.text + '|||' + quote.author;
        }

        // Function to update favorites count display
        function updateFavoritesCount() {
            const count = favorites.size;
            const favoritesCountEl = document.getElementById('favoritesCount');
            favoritesCountEl.textContent = `${count} favorite${count !== 1 ? 's' : ''} saved`;
        }

        // Export functions
        function formatQuotesAsText(quotesToExport) {
            let text = 'QUOTE COLLECTION EXPORT\n';
            text += '='.repeat(50) + '\n';
            text += `Exported on: ${new Date().toLocaleString()}\n`;
            text += `Total Quotes: ${quotesToExport.length}\n`;
            text += '='.repeat(50) + '\n\n';

            quotesToExport.forEach(function(quote, index) {
                text += `${index + 1}. "${quote.text}"\n`;
                text += `   ‚Äî ${quote.author}\n`;
                if (quote.categories && quote.categories.length > 0) {
                    text += `   Categories: ${quote.categories.join(', ')}\n`;
                }
                text += '\n';
            });

            return text;
        }

        function downloadTextFile(content, filename) {
            // Create a Blob with the text content
            const blob = new Blob([content], { type: 'text/plain' });

            // Create a temporary download link
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;

            // Trigger the download
            document.body.appendChild(link);
            link.click();

            // Clean up
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        }

        function exportQuotes(quotesToExport, filename) {
            if (quotesToExport.length === 0) {
                alert('No quotes to export!');
                return;
            }

            const textContent = formatQuotesAsText(quotesToExport);
            downloadTextFile(textContent, filename);
        }

        // Create an array to store all quotes
        // First, try to load from localStorage
        // If nothing is saved yet, use the initial quotes from data.js and save them
        let quotes;
        const savedQuotes = loadQuotes();

        // Check if saved quotes have categories - if not, we need to reload from initialQuotes
        const needsUpdate = savedQuotes && savedQuotes.length > 0 &&
                           (!savedQuotes[0].categories || !Array.isArray(savedQuotes[0].categories));

        if (savedQuotes && !needsUpdate) {
            // We have saved quotes with categories - use them
            quotes = savedQuotes;
        } else {
            // No saved quotes yet OR old quotes without categories - use initial quotes and save them
            quotes = [...initialQuotes];
            saveQuotes();
        }

        // Display Quote of the Day - deterministic based on today's date
        function displayQuoteOfTheDay() {
            const today = new Date();

            // Format date for display
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateString = today.toLocaleDateString('en-US', options);
            document.getElementById('todayDate').textContent = dateString;

            // Calculate day of year (1-365) to use as seed
            const start = new Date(today.getFullYear(), 0, 0);
            const diff = today - start;
            const oneDay = 1000 * 60 * 60 * 24;
            const dayOfYear = Math.floor(diff / oneDay);

            // Use day of year to deterministically pick the same quote each day
            // Only use quotes from initialQuotes (not user-added quotes)
            const quoteIndex = dayOfYear % initialQuotes.length;
            const todayQuote = initialQuotes[quoteIndex];

            // Display the quote
            document.getElementById('quoteOfDayText').textContent = '"' + todayQuote.text + '"';
            document.getElementById('quoteOfDayAuthor').innerHTML = '‚Äî ' + createWikipediaLink(todayQuote.author);
        }

        // Get references to HTML elements so we can interact with them
        // document.getElementById finds an element by its ID
        const form = document.getElementById('quoteForm');
        const quotesContainer = document.getElementById('quotesContainer');
        const randomButton = document.getElementById('randomButton');
        const anotherRandomButton = document.getElementById('anotherRandomButton');
        const showAllButton = document.getElementById('showAllButton');
        const searchInput = document.getElementById('searchInput');
        const searchResultsInfo = document.getElementById('searchResultsInfo');
        const clearFiltersButton = document.getElementById('clearFiltersButton');
        const showFavoritesButton = document.getElementById('showFavoritesButton');
        const showAllFromFavoritesButton = document.getElementById('showAllFromFavoritesButton');
        const exportCurrentButton = document.getElementById('exportCurrentButton');
        const exportFavoritesButton = document.getElementById('exportFavoritesButton');
        const exportAllButton = document.getElementById('exportAllButton');
        const exportPdfButton = document.getElementById('exportPdfButton');
        const emailButton = document.getElementById('emailButton');
        const shareTwitterButton = document.getElementById('shareTwitterButton');
        const shareFacebookButton = document.getElementById('shareFacebookButton');
        const shareLinkedInButton = document.getElementById('shareLinkedInButton');

        // Mobile filter button elements
        const mobileFilterBtn = document.getElementById('mobileFilterBtn');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const sidebarCloseBtn = document.getElementById('sidebarCloseBtn');

        // Variable to track if we're showing one random quote or all quotes
        let showingRandomQuote = false;

        // Variable to track if we're showing favorites only
        let showingFavorites = false;

        // Variable to track the current search term
        let currentSearchTerm = '';

        // Set to track selected categories (using Set for easy add/remove)
        let selectedCategories = new Set();

        // Set to track favorited quotes (stores quote IDs)
        let favorites = loadFavorites();

        // Helper function to create Wikipedia link from author name
        function createWikipediaLink(author) {
            let searchTerm;
            let tooltipName;

            // Check if author has parentheses (indicating movie character)
            const movieMatch = author.match(/\(([^)]+)\)/);

            if (movieMatch) {
                // It's a movie character - use the movie name for the search
                searchTerm = movieMatch[1].trim();
                tooltipName = movieMatch[1].trim();
            } else {
                // Regular person - use their name
                searchTerm = author.trim();
                tooltipName = author.trim();
            }

            // URL encode the search term to handle special characters
            const encodedSearch = encodeURIComponent(searchTerm);

            // Create Wikipedia search URL (redirects to page if exact match exists)
            const wikiUrl = `https://en.wikipedia.org/w/index.php?search=${encodedSearch}`;

            // Return HTML with link
            return `<a href="${wikiUrl}" target="_blank" rel="noopener noreferrer" class="wiki-link" title="Search ${tooltipName} on Wikipedia">${author}</a>`;
        }

        // Function to filter quotes based on search term, categories, and favorites
        // Returns an array of quotes that match the filters
        function getFilteredQuotes() {
            let filtered = quotes;

            // Filter by favorites first if in favorites mode
            if (showingFavorites) {
                filtered = filtered.filter(function(quote) {
                    return favorites.has(getQuoteId(quote));
                });
            }

            // Filter by search term
            if (currentSearchTerm) {
                const searchLower = currentSearchTerm.toLowerCase();
                filtered = filtered.filter(function(quote) {
                    const textLower = quote.text.toLowerCase();
                    const authorLower = quote.author.toLowerCase();
                    return textLower.includes(searchLower) || authorLower.includes(searchLower);
                });
            }

            // Filter by categories (if any are selected)
            // Uses AND logic - quote must have ALL selected categories
            if (selectedCategories.size > 0) {
                filtered = filtered.filter(function(quote) {
                    // Check if quote has categories property
                    if (!quote.categories || !Array.isArray(quote.categories)) {
                        return false;
                    }
                    // Check if quote has ALL of the selected categories
                    // Convert Set to Array and check if every selected category is in the quote
                    return Array.from(selectedCategories).every(function(selectedCat) {
                        return quote.categories.includes(selectedCat);
                    });
                });
            }

            return filtered;
        }

        // Listen for when user types in the search box
        // 'input' event fires every time the text changes
        searchInput.addEventListener('input', function(e) {
            // Update the current search term with what the user typed
            currentSearchTerm = e.target.value;

            // If we're in random quote mode, exit it when user searches
            if (showingRandomQuote) {
                showingRandomQuote = false;
                randomButton.style.display = 'inline-block';
                anotherRandomButton.style.display = 'none';
                showAllButton.style.display = 'none';
            }

            // Display the filtered quotes
            displayQuotes();
        });

        // Listen for category checkbox changes
        // Get all checkboxes with type="checkbox" inside category sections
        const categoryCheckboxes = document.querySelectorAll('.category-checkbox input[type="checkbox"]');
        categoryCheckboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                // When checkbox is checked, add category to selectedCategories
                // When unchecked, remove it
                if (this.checked) {
                    selectedCategories.add(this.value);
                } else {
                    selectedCategories.delete(this.value);
                }

                // If we're in random quote mode, exit it when user filters
                if (showingRandomQuote) {
                    showingRandomQuote = false;
                    randomButton.style.display = 'inline-block';
                    anotherRandomButton.style.display = 'none';
                    showAllButton.style.display = 'none';
                }

                // Display the filtered quotes
                displayQuotes();
            });
        });

        // Clear all filters button
        clearFiltersButton.addEventListener('click', function() {
            // Uncheck all category checkboxes
            categoryCheckboxes.forEach(function(checkbox) {
                checkbox.checked = false;
            });

            // Clear the selected categories set
            selectedCategories.clear();

            // Display all quotes
            displayQuotes();
        });

        // Mobile filter button functionality
        // Open sidebar when filter button is clicked
        mobileFilterBtn.addEventListener('click', function() {
            sidebar.classList.add('active');
            sidebarOverlay.classList.add('active');
        });

        // Function to close the sidebar
        function closeSidebar() {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
        }

        // Close sidebar when close button is clicked
        sidebarCloseBtn.addEventListener('click', closeSidebar);

        // Close sidebar when overlay backdrop is clicked
        sidebarOverlay.addEventListener('click', closeSidebar);

        // Listen for when the form is submitted (when user clicks "Add Quote")
        // addEventListener watches for events (like submit, click, etc.)
        form.addEventListener('submit', function(e) {
            // Prevent the page from reloading (default form behavior)
            e.preventDefault();

            // Get the values that the user typed into the form fields
            // .value gives us the current text inside an input
            const quoteText = document.getElementById('quoteText').value;
            const quoteAuthor = document.getElementById('quoteAuthor').value;

            // Add the new quote to our quotes array
            // push() adds an item to the end of an array
            // We're adding an object with two properties: text and author
            quotes.push({
                text: quoteText,
                author: quoteAuthor
            });

            // Save the updated quotes array to localStorage
            saveQuotes();

            // Clear the search so user can see their new quote
            currentSearchTerm = '';
            searchInput.value = '';

            // Call the function to display all quotes on the page
            displayQuotes();

            // Clear the form inputs so user can add another quote
            form.reset();
        });

        // Random Quote button - show one random quote (initial click)
        randomButton.addEventListener('click', function() {
            showingRandomQuote = true;
            displayRandomQuote();
            // Hide the initial "Show Random Quote" button
            // Show both "Show Another Random Quote" and "Show All Quotes" buttons
            randomButton.style.display = 'none';
            anotherRandomButton.style.display = 'inline-block';
            showAllButton.style.display = 'inline-block';
        });

        // Another Random Quote button - show another random quote
        anotherRandomButton.addEventListener('click', function() {
            // Display another random quote
            displayRandomQuote();
        });

        // Show All Quotes button - return to showing all quotes
        showAllButton.addEventListener('click', function() {
            showingRandomQuote = false;
            displayQuotes();
            // Reset buttons: show the initial "Show Random Quote" button
            // Hide the "Show Another Random Quote" and "Show All Quotes" buttons
            randomButton.style.display = 'inline-block';
            anotherRandomButton.style.display = 'none';
            showAllButton.style.display = 'none';
        });

        // Show Favorites button - show only favorited quotes
        showFavoritesButton.addEventListener('click', function() {
            showingFavorites = true;
            showingRandomQuote = false;
            displayQuotes();
            // Update button visibility
            showFavoritesButton.classList.add('active');
            showAllFromFavoritesButton.style.display = 'inline-block';
            // Hide random quote buttons if they're showing
            randomButton.style.display = 'inline-block';
            anotherRandomButton.style.display = 'none';
            showAllButton.style.display = 'none';
        });

        // Show All from Favorites button - return to showing all quotes
        showAllFromFavoritesButton.addEventListener('click', function() {
            showingFavorites = false;
            displayQuotes();
            // Update button visibility
            showFavoritesButton.classList.remove('active');
            showAllFromFavoritesButton.style.display = 'none';
        });

        // Export buttons event listeners
        exportCurrentButton.addEventListener('click', function() {
            // Export currently displayed/filtered quotes
            const quotesToExport = getFilteredQuotes();
            const timestamp = new Date().toISOString().split('T')[0];
            let filename = `quotes-current-view-${timestamp}.txt`;

            if (showingFavorites) {
                filename = `quotes-favorites-${timestamp}.txt`;
            } else if (currentSearchTerm || selectedCategories.size > 0) {
                filename = `quotes-filtered-${timestamp}.txt`;
            }

            exportQuotes(quotesToExport, filename);
        });

        exportFavoritesButton.addEventListener('click', function() {
            // Export only favorited quotes
            const favoritedQuotes = quotes.filter(function(quote) {
                return favorites.has(getQuoteId(quote));
            });
            const timestamp = new Date().toISOString().split('T')[0];
            exportQuotes(favoritedQuotes, `quotes-favorites-${timestamp}.txt`);
        });

        exportAllButton.addEventListener('click', function() {
            // Export all quotes
            const timestamp = new Date().toISOString().split('T')[0];
            exportQuotes(quotes, `quotes-all-${timestamp}.txt`);
        });

        // Export as PDF button
        exportPdfButton.addEventListener('click', function() {
            // Get currently displayed quotes
            const quotesToExport = getFilteredQuotes();

            if (quotesToExport.length === 0) {
                alert('No quotes to export! Please adjust your filters or add some quotes.');
                return;
            }

            // Initialize jsPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Set up document properties
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 20;
            const maxWidth = pageWidth - (margin * 2);
            let yPosition = margin;

            // Add title
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('Quote Collection', margin, yPosition);
            yPosition += 8;

            // Add URL
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.setTextColor(52, 152, 219); // Blue color for URL
            doc.text('https://notaibot.github.io/quoted/', margin, yPosition);
            doc.setTextColor(0, 0, 0); // Reset to black
            yPosition += 8;

            // Add date
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            const today = new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            doc.text(`Exported on: ${today}`, margin, yPosition);
            yPosition += 5;
            doc.text(`Total Quotes: ${quotesToExport.length}`, margin, yPosition);
            yPosition += 10;

            // Add separator line
            doc.setDrawColor(52, 152, 219);
            doc.setLineWidth(0.5);
            doc.line(margin, yPosition, pageWidth - margin, yPosition);
            yPosition += 10;

            // Add quotes
            quotesToExport.forEach(function(quote, index) {
                // Check if we need a new page
                if (yPosition > pageHeight - 40) {
                    doc.addPage();
                    yPosition = margin;
                }

                // Quote number
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                doc.text(`${index + 1}.`, margin, yPosition);

                // Quote text
                doc.setFontSize(11);
                doc.setFont(undefined, 'italic');
                const quoteText = `"${quote.text}"`;
                const quoteSplitText = doc.splitTextToSize(quoteText, maxWidth - 10);
                doc.text(quoteSplitText, margin + 5, yPosition);
                yPosition += (quoteSplitText.length * 6);

                // Author
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text(`‚Äî ${quote.author}`, margin + 10, yPosition);
                yPosition += 8;

                // Categories (if available)
                if (quote.categories && quote.categories.length > 0) {
                    doc.setFontSize(8);
                    doc.setTextColor(100, 100, 100);
                    doc.text(`Categories: ${quote.categories.join(', ')}`, margin + 10, yPosition);
                    doc.setTextColor(0, 0, 0);
                    yPosition += 6;
                }

                yPosition += 4; // Space between quotes
            });

            // Add footer on last page
            const totalPages = doc.internal.pages.length - 1; // Subtract the first empty page
            for (let i = 1; i <= totalPages; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(150, 150, 150);
                doc.text(
                    `Page ${i} of ${totalPages}`,
                    pageWidth / 2,
                    pageHeight - 10,
                    { align: 'center' }
                );
                doc.text(
                    'Generated from https://notaibot.github.io/quoted/',
                    pageWidth / 2,
                    pageHeight - 5,
                    { align: 'center' }
                );
            }

            // Generate filename with timestamp
            const timestamp = new Date().toISOString().split('T')[0];
            let filename = `quotes-${timestamp}.pdf`;

            if (showingFavorites) {
                filename = `quotes-favorites-${timestamp}.pdf`;
            } else if (currentSearchTerm || selectedCategories.size > 0) {
                filename = `quotes-filtered-${timestamp}.pdf`;
            }

            // Save the PDF
            doc.save(filename);
        });

        // Email quotes button
        emailButton.addEventListener('click', function() {
            // Get currently displayed quotes
            const quotesToEmail = getFilteredQuotes();

            if (quotesToEmail.length === 0) {
                alert('No quotes to share! Please adjust your filters or add some quotes.');
                return;
            }

            // Create email body with quotes (limit to first 5 to avoid mailto URL length limits)
            const quotesToShare = quotesToEmail.slice(0, 5);
            let emailBody = 'Check out these inspiring quotes from my Quote Collection:\n\n';

            quotesToShare.forEach(function(quote, index) {
                emailBody += `${index + 1}. "${quote.text}"\n   ‚Äî ${quote.author}\n\n`;
            });

            if (quotesToEmail.length > 5) {
                emailBody += `...and ${quotesToEmail.length - 5} more quotes!\n\n`;
            }

            emailBody += 'Visit the Quote Collection: https://notaibot.github.io/quoted/';

            // Create mailto link
            const subject = 'Inspiring Quotes to Share';
            const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;

            // Open email client
            window.location.href = mailtoLink;
        });

        // Share on Twitter button
        shareTwitterButton.addEventListener('click', function() {
            // Get a random quote from currently displayed quotes
            const quotesToShare = getFilteredQuotes();

            if (quotesToShare.length === 0) {
                alert('No quotes to share! Please adjust your filters or add some quotes.');
                return;
            }

            const randomQuote = quotesToShare[Math.floor(Math.random() * quotesToShare.length)];
            const tweetText = `"${randomQuote.text}" ‚Äî ${randomQuote.author}\n\n#Quotes #Inspiration`;
            const tweetUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}&url=${encodeURIComponent('https://notaibot.github.io/quoted/')}`;

            // Open Twitter in new window
            window.open(tweetUrl, '_blank', 'width=550,height=420');
        });

        // Share on Facebook button
        shareFacebookButton.addEventListener('click', function() {
            // Facebook share URL
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent('https://notaibot.github.io/quoted/')}`;

            // Open Facebook in new window
            window.open(facebookUrl, '_blank', 'width=550,height=420');
        });

        // Share on LinkedIn button
        shareLinkedInButton.addEventListener('click', function() {
            // Get a random quote from currently displayed quotes
            const quotesToShare = getFilteredQuotes();

            if (quotesToShare.length === 0) {
                alert('No quotes to share! Please adjust your filters or add some quotes.');
                return;
            }

            const randomQuote = quotesToShare[Math.floor(Math.random() * quotesToShare.length)];
            const linkedInUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent('https://notaibot.github.io/quoted/')}`;

            // Open LinkedIn in new window
            window.open(linkedInUrl, '_blank', 'width=550,height=420');
        });

        // When the page first loads, display quote of the day and all quotes
        displayQuoteOfTheDay();
        displayQuotes();
        updateFavoritesCount();

        // Back to Top button functionality
        const backToTopBtn = document.getElementById('backToTopBtn');

        // Show/hide button based on scroll position
        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                // Show button when scrolled down more than 300px
                backToTopBtn.classList.add('visible');
            } else {
                // Hide button when near the top
                backToTopBtn.classList.remove('visible');
            }
        });

        // Scroll to top when button is clicked
        backToTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Function to display all quotes on the page
        function displayQuotes() {
            // Clear everything in the container (start fresh)
            quotesContainer.innerHTML = '';

            // Get the filtered quotes based on current search term
            const filteredQuotes = getFilteredQuotes();

            // Update search results info
            if (currentSearchTerm) {
                // Show how many results match the search
                searchResultsInfo.textContent = `Found ${filteredQuotes.length} quote${filteredQuotes.length !== 1 ? 's' : ''} matching "${currentSearchTerm}"`;
            } else {
                // Clear the info when not searching
                searchResultsInfo.textContent = '';
            }

            // If no quotes match, show a message with option to add quote
            if (filteredQuotes.length === 0) {
                quotesContainer.innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="color: #7f8c8d; font-size: 1.2em; margin-bottom: 20px;">No quotes found matching your filters.</p>
                        <p style="color: #95a5a6; margin-bottom: 20px;">Be the first to add one!</p>
                        <button id="scrollToAddQuote" class="add-button">Add a Quote</button>
                    </div>
                `;

                // Add click handler to scroll to add quote form
                const scrollButton = document.getElementById('scrollToAddQuote');
                if (scrollButton) {
                    scrollButton.addEventListener('click', function() {
                        // Scroll to the add quote form
                        const addQuoteSection = document.querySelector('.add-quote-section');
                        addQuoteSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                        // Focus on the quote text input
                        setTimeout(function() {
                            document.getElementById('quoteText').focus();
                        }, 500);
                    });
                }
                return;
            }

            // Loop through each filtered quote
            // forEach runs the function once for each item
            // We need to find the original index in the full quotes array for deletion
            filteredQuotes.forEach(function(quote) {
                // Find the index of this quote in the original quotes array
                const index = quotes.indexOf(quote);
                // Create a new div element for this quote
                const quoteDiv = document.createElement('div');

                // Give it the same class as existing quotes (for styling)
                quoteDiv.className = 'quote-container';

                // Set the HTML content inside the div
                // Backticks (`) allow us to use ${} to insert variables
                // We add a delete button with a unique data attribute to track which quote it is
                // Build category tags HTML if quote has categories
                let categoriesHTML = '';
                if (quote.categories && Array.isArray(quote.categories) && quote.categories.length > 0) {
                    categoriesHTML = '<div class="quote-categories">' +
                        quote.categories.map(function(cat) {
                            // Check if this category is currently selected
                            const isSelected = selectedCategories.has(cat);
                            const tooltip = isSelected ? 'Click to unfilter' : 'Click to show all quotes with this tag';
                            const style = isSelected ? ' style="background-color: #ff9933;"' : '';
                            return '<span class="category-tag" title="' + tooltip + '"' + style + '>' + cat + '</span>';
                        }).join('') +
                        '</div>';
                }

                // Check if this quote is favorited
                const quoteId = getQuoteId(quote);
                const isFavorited = favorites.has(quoteId);
                const heartIcon = isFavorited ? '‚ù§Ô∏è' : 'ü§ç';

                quoteDiv.innerHTML = `
                    <button class="favorite-button ${isFavorited ? 'favorited' : ''}" data-quote-index="${index}" title="${isFavorited ? 'Remove from favorites' : 'Add to favorites'}">${heartIcon}</button>
                    <p class="quote-text">"${quote.text}"</p>
                    <p class="quote-author">‚Äî ${createWikipediaLink(quote.author)}</p>
                    ${categoriesHTML}
                `;

                // Add this quote div to the page
                // appendChild adds it as a child of quotesContainer
                quotesContainer.appendChild(quoteDiv);

                // Add click event listener to favorite button
                const favoriteBtn = quoteDiv.querySelector('.favorite-button');
                favoriteBtn.addEventListener('click', function() {
                    const quoteIndex = parseInt(this.getAttribute('data-quote-index'));
                    const quote = quotes[quoteIndex];
                    const quoteId = getQuoteId(quote);

                    if (favorites.has(quoteId)) {
                        // Remove from favorites
                        favorites.delete(quoteId);
                        this.textContent = 'ü§ç';
                        this.classList.remove('favorited');
                        this.setAttribute('title', 'Add to favorites');
                    } else {
                        // Add to favorites
                        favorites.add(quoteId);
                        this.textContent = '‚ù§Ô∏è';
                        this.classList.add('favorited');
                        this.setAttribute('title', 'Remove from favorites');
                    }

                    // Save to localStorage
                    saveFavorites();
                    updateFavoritesCount();
                });

                // Add click event listeners to category tags
                if (quote.categories && Array.isArray(quote.categories) && quote.categories.length > 0) {
                    const categoryTags = quoteDiv.querySelectorAll('.category-tag');
                    categoryTags.forEach(function(tag) {
                        tag.addEventListener('click', function() {
                            const categoryName = this.textContent;

                            // Find the corresponding checkbox
                            const checkbox = Array.from(categoryCheckboxes).find(function(cb) {
                                return cb.value === categoryName;
                            });

                            if (checkbox) {
                                // Toggle the checkbox
                                checkbox.checked = !checkbox.checked;

                                // Add or remove from selected categories
                                if (checkbox.checked) {
                                    selectedCategories.add(categoryName);
                                } else {
                                    selectedCategories.delete(categoryName);
                                }

                                // If we're in random quote mode, exit it
                                if (showingRandomQuote) {
                                    showingRandomQuote = false;
                                    randomButton.style.display = 'inline-block';
                                    anotherRandomButton.style.display = 'none';
                                    showAllButton.style.display = 'none';
                                }

                                // Update the display
                                displayQuotes();

                                // Scroll to top of quotes to see filtered results
                                quotesContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }
                        });
                    });
                }
            });
        }

        // Function to display one random quote
        function displayRandomQuote() {
            // Clear everything in the container (start fresh)
            quotesContainer.innerHTML = '';

            // Check if we have any quotes to display
            if (quotes.length === 0) {
                quotesContainer.innerHTML = '<p style="text-align: center; color: #7f8c8d;">No quotes available. Add some quotes first!</p>';
                return;
            }

            // Get a random index from the quotes array
            // Math.random() gives a number between 0 and 1
            // Math.floor() rounds down to get a whole number
            const randomIndex = Math.floor(Math.random() * quotes.length);
            const quote = quotes[randomIndex];

            // Create a new div element for this quote
            const quoteDiv = document.createElement('div');
            quoteDiv.className = 'quote-container';

            // Build category tags HTML if quote has categories
            let categoriesHTML = '';
            if (quote.categories && Array.isArray(quote.categories) && quote.categories.length > 0) {
                categoriesHTML = '<div class="quote-categories">' +
                    quote.categories.map(function(cat) {
                        // Check if this category is currently selected
                        const isSelected = selectedCategories.has(cat);
                        const tooltip = isSelected ? 'Click to unfilter' : 'Click to show all quotes with this tag';
                        const style = isSelected ? ' style="background-color: #ff9933;"' : '';
                        return '<span class="category-tag" title="' + tooltip + '"' + style + '>' + cat + '</span>';
                    }).join('') +
                    '</div>';
            }

            // Check if this quote is favorited
            const quoteId = getQuoteId(quote);
            const isFavorited = favorites.has(quoteId);
            const heartIcon = isFavorited ? '‚ù§Ô∏è' : 'ü§ç';

            // Set the HTML content
            quoteDiv.innerHTML = `
                <button class="favorite-button ${isFavorited ? 'favorited' : ''}" data-quote-index="${randomIndex}" title="${isFavorited ? 'Remove from favorites' : 'Add to favorites'}">${heartIcon}</button>
                <p class="quote-text">"${quote.text}"</p>
                <p class="quote-author">‚Äî ${createWikipediaLink(quote.author)}</p>
                ${categoriesHTML}
            `;

            // Add this quote div to the page
            quotesContainer.appendChild(quoteDiv);

            // Add click event listener to favorite button
            const favoriteBtn = quoteDiv.querySelector('.favorite-button');
            favoriteBtn.addEventListener('click', function() {
                const quoteIndex = parseInt(this.getAttribute('data-quote-index'));
                const quote = quotes[quoteIndex];
                const quoteId = getQuoteId(quote);

                if (favorites.has(quoteId)) {
                    // Remove from favorites
                    favorites.delete(quoteId);
                    this.textContent = 'ü§ç';
                    this.classList.remove('favorited');
                    this.setAttribute('title', 'Add to favorites');
                } else {
                    // Add to favorites
                    favorites.add(quoteId);
                    this.textContent = '‚ù§Ô∏è';
                    this.classList.add('favorited');
                    this.setAttribute('title', 'Remove from favorites');
                }

                // Save to localStorage
                saveFavorites();
                updateFavoritesCount();
            });

            // Add click event listeners to category tags
            if (quote.categories && Array.isArray(quote.categories) && quote.categories.length > 0) {
                const categoryTags = quoteDiv.querySelectorAll('.category-tag');
                categoryTags.forEach(function(tag) {
                    tag.addEventListener('click', function() {
                        const categoryName = this.textContent;

                        // Find the corresponding checkbox
                        const checkbox = Array.from(categoryCheckboxes).find(function(cb) {
                            return cb.value === categoryName;
                        });

                        if (checkbox) {
                            // Toggle the checkbox
                            checkbox.checked = !checkbox.checked;

                            // Add or remove from selected categories
                            if (checkbox.checked) {
                                selectedCategories.add(categoryName);
                            } else {
                                selectedCategories.delete(categoryName);
                            }

                            // If we're in random quote mode, exit it
                            if (showingRandomQuote) {
                                showingRandomQuote = false;
                                randomButton.style.display = 'inline-block';
                                anotherRandomButton.style.display = 'none';
                                showAllButton.style.display = 'none';
                            }

                            // Update the display
                            displayQuotes();

                            // Scroll to top of quotes to see filtered results
                            quotesContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    });
                });
            }
        }
    </script>
</body>
</html>
